
	FUNCTION MBSL2(N,X)
	DOUBLE PRECISION MBSL2,X,MBSL1
	DOUBLE PRECISION Y,Z,P,Q,S,B0,B1
	DOUBLE PRECISION A(6),B(6),C(6),D(7),E(5),F(5),G(5),H(5)
	DATA A/-2.957821389D+09,7.062834065D+09,-5.123598036D+08,
     *        1.087988129D+07,-8.632792757D+04,2.284622733D+02/
	DATA B/4.0076544269D+10,7.452499648D+08,7.189466438D+06,
     *         4.74472647D+04,2.261030244D+02,1.0/
	DATA C/-4.900604943D+12,1.27527439D+12,-5.153438139D+10,
     *         7.349264551D+08,-4.237922726D+06,8.511937935D+03/
	DATA D/2.49958057D+13,4.244419664D+11,3.733650367D+09,
     *         2.245904002D+07,1.02042605D+05,3.549632885D+02,1.0/
	DATA E/1.0,-0.1098628627D-02,0.2734510407D-04,
     *         -0.2073370639D-05,0.2093887211D-06/
	DATA F/-0.1562499995D-01,0.1430488765D-03,-0.6911147651D-05,
     *         0.7621095161D-06,-0.934935152D-07/
	DATA G/1.0,0.183105D-02,-0.3516396496D-04,
     *         0.2457520174D-05,-0.240337019D-06/
	DATA H/0.4687499995D-01,-0.2002690873D-03,0.8449199096D-05,
     *         -0.88228987D-06,0.105787412D-06/
	IF (N.LT.0) N=-N
	IF (X.LT.0.0) X=-X
	IF (X+1.0.EQ.1.0) THEN
	  MBSL2=-1.0D+35
	  RETURN
	END IF
	IF (N.NE.1) THEN
	  IF (X.LT.8.0) THEN
	    Y=X*X
	    P=A(6)
	    Q=B(6)
	    DO 10 I=5,1,-1
	      P=P*Y+A(I)
	      Q=Q*Y+B(I)
10	    CONTINUE
	    P=P/Q+0.636619772*MBSL1(0,X)*LOG(X)
	  ELSE
	    Z=8.0/X
	    Y=Z*Z
	    P=E(5)
	    Q=F(5)
	    DO 20 I=4,1,-1
	      P=P*Y+E(I)
	      Q=Q*Y+F(I)
20	    CONTINUE
	    S=X-0.785398164
	    P=P*SIN(S)+Z*Q*COS(S)
	    P=P*SQRT(0.636619772/X)
	  END IF
	END IF
	IF (N.EQ.0) THEN
	  MBSL2=P
	  RETURN
	END IF
	B0=P
	IF (X.LT.8.0) THEN
	  Y=X*X
	  P=C(6)
	  Q=D(7)
	  DO 30 I=5,1,-1
	    P=P*Y+C(I)
	    Q=Q*Y+D(I+1)
30	  CONTINUE
	  Q=Q*Y+D(1)
	  P=X*P/Q+0.636619772*(MBSL1(1,X)*LOG(X)-1.0/X)
	ELSE
	  Z=8.0/X
	  Y=Z*Z
	  P=G(5)
	  Q=H(5)
	  DO 40 I=4,1,-1
	    P=P*Y+G(I)
	    Q=Q*Y+H(I)
40	  CONTINUE
	  S=X-2.356194491
	  P=P*SIN(S)+Z*Q*COS(S)
	  P=P*SQRT(0.636619772/X)
	END IF
	IF (N.EQ.1) THEN
	  MBSL2=P
	  RETURN
	END IF
	B1=P
	S=2.0/X
	DO 50 I=1,N-1
	  P=S*I*B1-B0
	  B0=B1
	  B1=P
50	CONTINUE
	MBSL2=P
	RETURN
	END


