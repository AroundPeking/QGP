
	SUBROUTINE DNETN(N,X,Y,EPS,FS,T,H,A,B,L,JS)
	DIMENSION X(N),Y(N),A(N,N),B(N),JS(N)
	DOUBLE PRECISION X,Y,A,B,T,H,AM,Z,BETA,D
	L=100
10	CALL FS(X,B,N)
	AM=0.0
	DO 20 I=1,N
	  IF (ABS(B(I)).GT.AM) AM=ABS(B(I))
20	CONTINUE
	IF (AM.LT.EPS) RETURN
	L=L-1
	IF (L.EQ.0) THEN
	  WRITE(*,100)
	  RETURN
	END IF
100	FORMAT(1X,'  FAIL')
	DO 40 J=1,N
	  Z=X(J)
	  X(J)=X(J)+H
	  CALL FS(X,Y,N)
	  DO 30 I=1,N
30	  A(I,J)=Y(I)
	  X(J)=Z
40	CONTINUE
	CALL AGAUS(A,B,N,Y,K,JS)
	IF (K.EQ.0) THEN
	  L=-1
	  RETURN
	END IF
	BETA=1.0
	DO 50 I=1,N
50	BETA=BETA-Y(I)
	IF (ABS(BETA)+1.0.EQ.1.0) THEN
	  L=-2
	  WRITE(*,100)
	  RETURN
	END IF
	D=H/BETA
	DO 60 I=1,N
60	X(I)=X(I)-D*Y(I)
	H=T*H
	GOTO 10
	END


